#!/bin/bash


NODE_BIN=$(npm bin)

OUT_FILE="GeneratedTypes.d.ts"
echo "Generating ${OUT_FILE}..."
echo > "${OUT_FILE}" "\
/**
 * This file was automatically generated by generate-types.sh.
 * 
 * DO NOT MODIFY IT BY HAND.
 *
 * Instead:
 * - modify the validation/*.schema.json files;
 * - then, run generate-types.sh to regenerate this file.
 */

$("node" "generate-types.js" ../validation)"
"${NODE_BIN}/eslint" "${OUT_FILE}" --fix

VAR_DOC_FILE="reduce.algo2/docs/variables.json"
echo "Generating ${VAR_DOC_FILE}..."
"${NODE_BIN}/ts-node" "reduce.algo2/docs/generate-docs.ts" \
  "reduce.algo2/map.ts" \
  "reduce.algo2/finalize.ts" \
  > "${VAR_DOC_FILE}"
